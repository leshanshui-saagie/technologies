(this.webpackJsonp=this.webpackJsonp||[]).push([["tc-story-highlighted-kpi"],{"/app/node_modules/babel-loader/lib/index.js??ref--6-0!/app/app/scripts/charts/highlighted-kpi/config-processor.js 41970ad591a4e478a522c9ff4865ab55":function(e,a,t){"use strict";var n=t("/app/node_modules/lodash/lodash.js"),i=t.n(n),s=t("/app/node_modules/babel-loader/lib/index.js??ref--7-0!/app/node_modules/coffee-loader/index.js!/app/app/scripts/dataset/fetch/row.coffee"),r=t.n(s),o=t("/app/node_modules/babel-loader/lib/index.js??ref--7-0!/app/node_modules/coffee-loader/index.js!/app/app/scripts/services/specifiers/precision-manager.coffee"),l=t.n(o),d=t("/app/node_modules/babel-loader/lib/index.js??ref--7-0!/app/node_modules/coffee-loader/index.js!/app/app/scripts/services/specifiers/sentiment-manager.coffee"),u=t.n(d),p=t("/app/node_modules/babel-loader/lib/index.js??ref--7-0!/app/node_modules/coffee-loader/index.js!/app/app/scripts/services/specifiers/unit-manager.coffee"),c=t.n(p),f=t("/app/node_modules/babel-loader/lib/index.js??ref--7-0!/app/node_modules/coffee-loader/index.js!/app/app/scripts/utils/template-parser.coffee"),m=t("/app/node_modules/d3/index.js 5cb1878562f26aa32fe2f370b955e08f"),h=t("/app/node_modules/babel-loader/lib/index.js??ref--7-0!/app/node_modules/coffee-loader/index.js!/app/app/scripts/dataset/augmenter/extenders/index.coffee"),b=function(e,a){var t;return t=i.a.cloneDeep(e),i.a.each(["units","precision","sentiment"],function(e){if(a[e])return h.a[e](a[e])(t)}),t},g=t("/app/node_modules/babel-loader/lib/index.js??ref--7-0!/app/node_modules/coffee-loader/index.js!/app/app/scripts/dataset/utils/delete-void-entries-in-place.coffee"),v=t.n(g);function _(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}t.d(a,"a",function(){return x}),t.d(a,"b",function(){return j}),t.d(a,"c",function(){return y});var x=function(e,a){if(a&&a.length){var t=JSON.stringify(e),n=a.find(function(e){return t.includes("".concat(e,"."))});return n||a[a.length-1]}},j=function(e,a){var t,n,s;if(i.a.isEmpty(a)||!i.a.includes(e.value,"."))return{};var r=i.a.mapValues(a,function(e){return i.a.has(e,"filteredData")?e.filteredData[0]:{}}),o=i.a.mapValues(r,function(e){return i.a.mapValues(e,function(a,t){return"".concat(l.a.format(e,t)).concat(c.a.get(e,t))})}),d=i.a.mapValues(e,function(e){return f.default.parseWithVars(e,o,{delimiters:f.default.localVariablesDelimiters})});if(i.a.has(d,"badge")&&"bullet"!==d.badge){var p=i.a.get(r,d.badge);t=p>0?"arrow_up":p<0?"arrow_down":"arrow_equal"}else t=d.badge;var m=i.a.split(d.value,"."),h=m[0],b=m[1],g=r[h];if(i.a.has(d,"sentiment")){var v=i.a.split(d.sentiment,"."),_=v[0];n=v[1],s=r[_]}else n=b,s=g;return i.a.assign({},i.a.pick(d,["comment","name","source","title"]),{badge:t,sentiment:u.a.computeLabel(s,n),value:{format:l.a.get(g,b),unit:c.a.get(g,b),value:i.a.get(g,b)}})},y=function(e,a){v()(a);var t=a.value||"value",n=i.a.map(a.data,function(a,t){return{promise:r()(e,a),key:t}});return Promise.all(i.a.map(n,function(e){return e.promise})).then(function(e){return i.a.fromPairs(i.a.map(e,function(e,a){return[n[a].key,e]}))}).then(function(e){return i.a.mapValues(e,function(e,t){var n={};null!=a.unit?n.units=_({},a.data[t].field,a.unit):a.units&&a.units[t]&&(n.units=_({},a.data[t].field,a.units[t])),i.a.isString(a.precision)?n.precision=_({},a.data[t].field,a.precision):a.precision&&a.precision[t]&&(n.precision=_({},a.data[t].field,a.precision[t])),(null!=a.sentiment?a.sentiment[t]:void 0)?n.sentiment=_({},a.data[t].field,a.sentiment[t]):null!=(null!=a.sentiment?a.sentiment.domain:void 0)&&null!=(null!=a.sentiment?a.sentiment.range:void 0)&&(n.sentiment=_({},a.data[t].field,a.sentiment));var s=b([e],n)[0];return{value:s[a.data[t].field],unit:c.a.get(s,a.data[t].field),format:l.a.get(s,a.data[t].field),sentiment:u.a.get(s,a.data[t].field),formattedValue:"".concat(l.a.format(s,a.data[t].field)).concat(c.a.get(s,a.data[t].field)),row:s}})}).then(function(e){var n=i.a.cloneDeep(a);if(null!=a.compute&&i.a.forEach(a.compute,function(t,n){try{var s=i.a.mapValues(e,"value"),r=+i.a.template("<%=".concat(t,"%>"))(s),o=i.a.get(a,"units")[n]||"",l=i.a.get(a,"precision")[n],d=l?m.format(l):i.a.identity;return e[n]={value:r,unit:o,format:l,formattedValue:"".concat(d(r)).concat(o)}}catch(a){return console.warn("              ".concat(n," variable has failed to be computed\n              Please check your query or computation variable.\n              Computation: ").concat(t,"\n              With variables: ").concat(JSON.stringify(e,null,2),"              ")),e[n]=NaN}}),null!=a.sentiment){var s=i.a.keys(a.sentiment)[0];n.sentiment=e[s].sentiment}if(null!=a.badge&&"bullet"!==a.badge){var r=null!=e[a.badge]?e[a.badge].value:void 0;null==r&&i.a.isNumber(r)?console.warn("            Impossible to find the sign of ".concat(a.badge," to update the badge\n            In variables: ").concat(JSON.stringify(e,null,2),"            ")):n.badge=r>0?"arrow_up":r<0?"arrow_down":"arrow_equal"}var o=i.a.mapValues(e,function(e){return e.formattedValue});return null!=e[t]?n.value=e[t]:n.value=void 0,i.a.map(["comment","source"],function(e){try{return n[e]=f.default.parseWithVars(n[e],o,{delimiters:f.default.localVariablesDelimiters})}catch(a){return console.warn("            ".concat(e," has failed to be templated\n            Please check your query or computation variable.\n            Template: ").concat(n[e],"\n            With variables: ").concat(JSON.stringify(o,null,2),"            "))}}),n})}},"/app/node_modules/babel-loader/lib/index.js??ref--6-0!/app/app/scripts/charts/highlighted-kpi/index.js 2493783a8a6c94cd3a166eebc7234df9":function(e,a,t){"use strict";t.r(a);var n=t("/app/node_modules/lodash/lodash.js"),i=t.n(n),s=t("/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/charts/components/value/vue/index.vue 950bda44cf6354e89e86547289bce599"),r=t("/app/node_modules/babel-loader/lib/index.js??ref--6-0!/app/app/scripts/slide/templated-property-mixin.js"),o=t("/app/node_modules/babel-loader/lib/index.js??ref--6-0!/app/app/scripts/charts/highlighted-kpi/config-processor.js 41970ad591a4e478a522c9ff4865ab55"),l={mixins:[Object(r.a)("config")],props:{config:{type:Object},datasets:{type:Object},fetchData:{type:Function}},data:function(){return{data:{}}},computed:{format:function(){return i.a.has(this.data.value,"format")?this.data.value.format:void 0},unit:function(){return i.a.has(this.data.value,"unit")?this.data.value.unit:void 0},value:function(){return i.a.has(this.data.value,"value")?this.data.value.value:void 0},sentiment:function(){return this.data.sentiment}},mounted:function(){return this.update()},methods:{configToData:function(){return i.a.has(this.configTemplated,"data")?Object(o.c)(this.fetchData,this.configTemplated):Promise.resolve(Object(o.b)(this.configTemplated,this.datasets))},update:function(){var e=this;return this.configToData().then(function(a){e.data=a})}},watch:{configTemplated:function(e,a){if(!i.a.isEqual(e,a))return this.update()},datasets:{deep:!0,handler:function(){return this.update()}}}},d=t("/app/node_modules/vue-template-loader/lib/template-loader.js??ref--1-oneOf-1-0!/app/node_modules/pug-plain-loader/index.js!/app/app/scripts/charts/highlighted-kpi/template.vue.pug"),u=t.n(d)()({name:"highlighted-kpi",mixins:[l],components:{TcValue:s.default},computed:{badgeClass:function(){return"highlighted-kpi__badge--".concat(i.a.startsWith(this.badgeSymbol,"arrow")?"icon":"bullet")},badgeSymbol:function(){return i.a.replace(this.data.badge,"evolution","arrow")},comment:function(){return this.data.comment},isStringValue:function(){return i.a.isString(this.value)},title:function(){return this.data.title||this.data.name}}});a.default=u},"/app/node_modules/babel-loader/lib/index.js??ref--7-0!/app/node_modules/coffee-loader/index.js!/app/app/scripts/dataset/augmenter/extenders/index.coffee":function(e,a,t){"use strict";(function(e){var n,i=t("/app/node_modules/babel-loader/lib/index.js??ref--7-0!/app/node_modules/coffee-loader/index.js!/app/app/scripts/dataset/augmenter/extenders/geofeatures.coffee"),s=t("/app/node_modules/babel-loader/lib/index.js??ref--7-0!/app/node_modules/coffee-loader/index.js!/app/app/scripts/services/specifiers/precision-manager.coffee"),r=t.n(s),o=t("/app/node_modules/babel-loader/lib/index.js??ref--7-0!/app/node_modules/coffee-loader/index.js!/app/app/scripts/services/specifiers/sentiment-manager.coffee"),l=t.n(o),d=t("/app/node_modules/babel-loader/lib/index.js??ref--7-0!/app/node_modules/coffee-loader/index.js!/app/app/scripts/services/specifiers/unit-manager.coffee"),u=t.n(d);n={precision:function(e){return function(a){return r.a.extend(a,e)}},sentiment:function(a){return function(t){return l.a.extend(t,a),e.each(t,function(a){if(a.__sentiment__)return a.__sentiment__=e.mapValues(a.__sentiment__,function(e,t){return l.a.compute(a,t)})})}},units:function(e){return function(a){return u.a.extend(a,e)}},geofeatures:Object(i.b)()},a.a=n}).call(this,t("/app/node_modules/lodash/lodash.js"))},"/app/node_modules/babel-loader/lib/index.js??ref--7-0!/app/node_modules/coffee-loader/index.js!/app/app/scripts/dataset/fetch/row.coffee":function(e,a){var t;t=function(e,a){return e(a).then(function(e){return e.length>1&&console.warn("Data request for one row returned "+e.length+" rows.\nMaybe you need to rework your query.\nRequest:",a),e.length<1?(console.warn("Data request for one row returned no rows.\nRequest:",a),e):e[0]})},e.exports=t},"/app/node_modules/vue-template-loader/lib/template-loader.js??ref--1-oneOf-1-0!/app/node_modules/pug-plain-loader/index.js!/app/app/scripts/charts/highlighted-kpi/template.vue.pug":function(e,a){var t=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"highlighted-kpi",attrs:{"data-sentiment":e.sentiment}},[e.badgeSymbol?t("div",{staticClass:"highlighted-kpi__badge",class:e.badgeClass,attrs:{"data-symbol":e.badgeSymbol}}):e._e(),t("div",{staticClass:"highlighted-kpi__text"},[t("div",{staticClass:"highlighted-kpi__text-first-row"},[e.isStringValue?t("div",{staticClass:"tc-value highlighted-kpi__value"},[t("div",{staticClass:"tc-value__value"},[e._v(e._s(e.value))])]):t("tc-value",{staticClass:"highlighted-kpi__value",attrs:{format:e.format,unit:e.unit,value:e.value}}),e.title?t("div",{staticClass:"highlighted-kpi__title"},[e._v(e._s(e.title))]):e._e(),e.configTemplatingError?t("error-message",{attrs:{"error-message":e.configTemplatingError,"default-collapsed":"",right:"-30px",top:"-25px"}}):e._e()],1),e.comment?t("div",{staticClass:"highlighted-kpi__comment"},[e._v(e._s(e.comment))]):e._e()])])},n=[];e.exports=function(e){var a="function"==typeof e?e.options:e;return a.render=t,a.staticRenderFns=n,e}}}]);