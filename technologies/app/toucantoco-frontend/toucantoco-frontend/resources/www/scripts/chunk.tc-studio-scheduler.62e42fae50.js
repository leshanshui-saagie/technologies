(this.webpackJsonp=this.webpackJsonp||[]).push([["tc-studio-scheduler"],{"/app/node_modules/babel-loader/lib/index.js!/app/node_modules/coffee-loader/index.js!/app/app/scripts/small-app/conceptor-tools/scheduler/index.coffee":function(e,s,n){"use strict";n.r(s);var t,a=n("/app/node_modules/lodash/lodash.js"),r=n.n(a),o=n("/app/node_modules/babel-loader/lib/index.js!/app/node_modules/coffee-loader/index.js!/app/app/scripts/api/index.coffee"),i=n("/app/node_modules/babel-loader/lib/index.js!/app/node_modules/coffee-loader/index.js!/app/app/scripts/utils/tc-storage/index.coffee d63dc4c7c5bfb12284d1e11d63fd1ebf"),c=n("/app/node_modules/babel-loader/lib/index.js!/app/app/scripts/studio/utils/tc-sheet/index.js"),d=n("/app/node_modules/vue-template-loader/lib/template-loader.js??ref--1-oneOf-1-0!/app/node_modules/pug-plain-loader/index.js!/app/app/scripts/small-app/conceptor-tools/scheduler/template.vue.pug");t=n.n(d)()({components:{TcSheet:c.default,scheduledAction:function(){return n.e("scheduler-action").then(n.bind(null,"/app/node_modules/babel-loader/lib/index.js!/app/node_modules/coffee-loader/index.js!/app/app/scripts/small-app/conceptor-tools/scheduler/scheduled-action/index.coffee"))}},props:{stage:{type:String,default:function(){return"staging"}}},data:function(){return{scheduledActions:void 0,username:void 0,hasChanges:!1}},computed:{smallAppId:function(){return this.$store.getters.smallAppId},empty:function(){return r.a.isEqual(this.scheduledActions,[])}},mounted:function(){return this.refreshScheduler(),this.username=Object(i.a)().currentUser},methods:{close:function(){return this.$emit("closed")},refreshScheduler:function(){return this.$store.dispatch("retrieveEtlConfig",this.stage).then((e=this,function(){return e.scheduledActions=r.a.cloneDeep(e.$store.getters.schedulerFromEtl||[]),e.hasChanges=!1}));var e},save:function(){return this.$store.dispatch("updateScheduler",r.a.cloneDeep(this.scheduledActions)).then((e=this,function(s){var n;return"OK"===s.status?e.hasChanges=!1:(n=r.a.get(s,"details[0].messages[0]"),alert("Could not save: "+n))}));var e},removeAction:function(e){return this.scheduledActions.splice(e,1),this.hasChanges=!0},addAction:function(){return this.scheduledActions.push({name:"new-action",operations:[],recurrence:["0 12 * * *"],usernames:[this.username]}),this.hasChanges=!0},runAction:function(e){return o.a.smallApp.operations.run(this.smallAppId,encodeURIComponent(e)).then(function(e){return console.log(e)})},editName:function(e,s){return this.scheduledActions[e].name=s,this.hasChanges=!0},editTimezone:function(e,s){return this.scheduledActions[e].timezone=s||void 0,this.hasChanges=!0},removeOperation:function(e,s){return this.scheduledActions[e].operations.splice(s,1),this.hasChanges=!0},editOperationType:function(e,s,n){return this.scheduledActions[e].operations[s].operation=n,this.hasChanges=!0},editOperationParameters:function(e,s,n){return void 0!==n&&(this.scheduledActions[e].operations[s].parameters=n),this.hasChanges=!0},addOperation:function(e){return this.scheduledActions[e].operations.push({operation:"preprocess_data_sources",parameters:{}}),this.hasChanges=!0},removeRecurrence:function(e,s){return this.scheduledActions[e].recurrence.splice(s,1),this.hasChanges=!0},editRecurrence:function(e,s,n){return this.scheduledActions[e].recurrence.splice(s,1,n),this.hasChanges=!0},addRecurrence:function(e){return this.scheduledActions[e].recurrence.push("0 12 * * *"),this.hasChanges=!0},removeUsername:function(e,s){return this.scheduledActions[e].usernames.splice(s,1),this.hasChanges=!0},editUsername:function(e,s,n){return this.scheduledActions[e].usernames.splice(s,1,n),this.hasChanges=!0},addUsername:function(e){return this.scheduledActions[e].usernames.push(""),this.hasChanges=!0}}}),s.default=t},"/app/node_modules/vue-template-loader/lib/template-loader.js??ref--1-oneOf-1-0!/app/node_modules/pug-plain-loader/index.js!/app/app/scripts/small-app/conceptor-tools/scheduler/template.vue.pug":function(e,s){var n=function(){var e=this,s=e.$createElement,n=e._self._c||s;return n("tc-sheet",{attrs:{hasToolbarLinks:!1,name:"Scheduler"},on:{closed:e.close}},[n("div",{staticClass:"scheduler__container"},[n("div",{staticClass:"scheduler__body"},[e.empty?n("div",[n("h2",[e._v("No action scheduled.")]),n("p",[e._v("This interface lets you schedule automatic actions, like a preprocess every morning. The recurrence rule uses the CRON syntax.")])]):n("div",e._l(e.scheduledActions,function(s,t){return n("scheduled-action",{attrs:{index:t,canRun:!e.hasChanges,name:s.name,operations:s.operations,recurrence:s.recurrence,timezone:s.timezone,usernames:s.usernames},on:{nameChanged:e.editName,timezoneChanged:e.editTimezone,recurrenceRemoved:e.removeRecurrence,recurrenceChanged:e.editRecurrence,recurrenceAdded:e.addRecurrence,usernameRemoved:e.removeUsername,usernameChanged:e.editUsername,usernameAdded:e.addUsername,operationRemoved:e.removeOperation,operationTypeChanged:e.editOperationType,operationParametersChanged:e.editOperationParameters,operationAdded:e.addOperation,runAction:e.runAction,removed:e.removeAction}})}),1),n("div",{staticClass:"scheduler_btn"},[n("button",{staticClass:"scheduler__button scheduler__button--add",on:{click:e.addAction}},[n("i",{staticClass:"fa fa-plus"}),e._v("Add a scheduled action")]),e.hasChanges?n("button",{staticClass:"scheduler__button",on:{click:e.refreshScheduler}},[n("i",{staticClass:"fa fa-undo"}),e._v("Cancel modifications")]):e._e(),e.hasChanges?n("button",{staticClass:"scheduler__button scheduler__button--save",on:{click:e.save}},[n("i",{staticClass:"fa fa-save"}),e._v("Save modifications")]):e._e()])])])])},t=[];e.exports=function(e){var s="function"==typeof e?e.options:e;return s.render=n,s.staticRenderFns=t,e}}}]);