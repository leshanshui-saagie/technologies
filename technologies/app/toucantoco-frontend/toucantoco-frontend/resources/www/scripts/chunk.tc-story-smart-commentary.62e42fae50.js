(this.webpackJsonp=this.webpackJsonp||[]).push([["tc-story-smart-commentary"],{"/app/node_modules/mini-css-extract-plugin/dist/loader.js!/app/node_modules/css-loader/dist/cjs.js??ref--5-1!/app/node_modules/vue-loader/lib/loaders/stylePostLoader.js!/app/node_modules/resolve-url-loader/index.js??ref--5-2!/app/node_modules/postcss-loader/src/index.js??ref--5-3!/app/node_modules/sass-loader/dist/cjs.js??ref--5-4!/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/slide/smart-commentary/index.vue?vue&type=style&index=0&id=17e15611&scoped=true&lang=scss&":function(e,s,t){},"/app/node_modules/mini-css-extract-plugin/dist/loader.js!/app/node_modules/css-loader/dist/cjs.js??ref--5-1!/app/node_modules/vue-loader/lib/loaders/stylePostLoader.js!/app/node_modules/resolve-url-loader/index.js??ref--5-2!/app/node_modules/postcss-loader/src/index.js??ref--5-3!/app/node_modules/sass-loader/dist/cjs.js??ref--5-4!/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/slide/smart-commentary/index.vue?vue&type=style&index=1&lang=scss&":function(e,s,t){},"/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/slide/smart-commentary/index.vue bee752a59a7aa4ca95d981dc34450545":function(e,s,t){"use strict";t.r(s);var a=[function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"tc-story__smart-commentary-logo"},[s("img",{attrs:{src:t("/app/node_modules/file-loader/dist/cjs.js??ref--10-0!/app/app/assets/images/icons/smart-toucan.svg")}})])}],o=t("/app/node_modules/lodash/lodash.js"),r=t.n(o),n=t("/app/node_modules/babel-loader/lib/index.js!/app/node_modules/coffee-loader/index.js!/app/app/scripts/charts/utils/tc-chart-utils.coffee"),i=t.n(n),d=t("/app/node_modules/babel-loader/lib/index.js!/app/node_modules/coffee-loader/index.js!/app/app/scripts/services/specifiers/precision-manager.coffee"),l=t.n(d),c=t("/app/node_modules/babel-loader/lib/index.js!/app/node_modules/coffee-loader/index.js!/app/app/scripts/services/specifiers/unit-manager.coffee"),p=t.n(c),u=function(e,s,t){var a=r.a.sum(r.a.map(s,t));return Math.round(100*e/a)},m=function(e,s,t){if(!(e.length<3)){var a=e.slice(0,3),o=r.a.sum(r.a.map(a,t)),n=u(o,e,t);return{content:"The sum of the top 3 represents ".concat(n,"% of the total ").concat(t),relatedLabels:a.map(function(e){return e[s]})}}},f=function(e,s,t){if(!r.a.isEmpty(e)){var a=r.a.head(e),o=a[s],n=a[t],i=u(n,e,t);return{content:'<div class="tc-story__smart-commentary-label">'.concat(o,"</div> is first with ").concat(i,"% of the total ").concat(t),relatedLabels:[o]}}},v=function(e,s,t){if(!r.a.isEmpty(e)){var a=r.a.last(e),o=a[s],n=a[t],i=u(n,e,t);return{content:'<div class="tc-story__smart-commentary-label">'.concat(o,"</div> is last with ").concat(i,"% of the total ").concat(t),relatedLabels:[o]}}};var h=function(e,s,t,a){if(!r.a.isEmpty(e)&&null!=a){var o=function(e,s){return r.a.chain(e).filter(function(e){return r.a.isNumber(e[s])}).sort(function(e,t){return Math.abs(t[s])-Math.abs(e[s])}).first().value()}(e,a);if(o){var n=o[s],i=o[a],d=i>=0?"increased":"decreased",c="".concat(l.a.format(o,a,!0)).concat(p.a.get(o,a));return{content:0===i?"".concat(t," didn't change"):'<div class="tc-story__smart-commentary-label">'.concat(n,"</div> ").concat(t," has ").concat(d," of ").concat(c),relatedLabels:[n]}}}};function j(e,s){return function(e){if(Array.isArray(e))return e}(e)||function(e,s){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var t=[],a=!0,o=!1,r=void 0;try{for(var n,i=e[Symbol.iterator]();!(a=(n=i.next()).done)&&(t.push(n.value),!s||t.length!==s);a=!0);}catch(e){o=!0,r=e}finally{try{a||null==i.return||i.return()}finally{if(o)throw r}}return t}(e,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var y={name:"SmartCommentary",inject:{storeNamespace:{default:function(){return""}}},props:{config:{type:[Boolean,Array],default:!0},datasets:{type:Object,default:function(){return{}}},chartConfigs:{type:Array,default:function(){return[]}},storyStoreNamespace:{type:String,default:""}},data:function(){return{commentaryIndex:0}},computed:{commentary:function(){return this.availableCommentaries[this.commentaryIndex]},commentaryContent:function(){return this.commentary?this.commentary.content:"Sorry, no smart commentaries are available"},firstData:function(){var e=r.a.head(Object.values(this.datasets));return r.a.get(e,"filteredData")},firstChartConfig:function(){return r.a.head(this.chartConfigs)||{}},availableCommentaries:function(){var e=this;return r.a.isEmpty(this.firstData)||r.a.isEmpty(this.firstChartConfig)?[]:Object.entries(this.generatedCommentariesObject).filter(function(s){var t=j(s,1)[0];return e.isCommentaryKeyAllowed(t)}).map(function(e){return j(e,2)[1]}).filter(r.a.isObject)},generatedCommentariesObject:function(){return"horizontal-barchart"===this.firstChartConfig.chartType?(e={data:this.firstData,labelSelector:this.firstChartConfig.label,valueSelector:this.firstChartConfig.value,variationSelector:this.firstChartConfig.variation},s=e.data,t=e.labelSelector,a=e.valueSelector,o=e.variationSelector,r=i.a.orderingFunction({by:a,reverse:!0})(s),{sumOfTopThree:m(r,t,a),first:f(r,t,a),last:v(r,t,a),biggestVariation:h(s,t,a,o)}):{};var e,s,t,a,o,r}},watch:{commentary:{immediate:!0,handler:function(){var e=r.a.get(this.commentary,"relatedLabels",[]);this.$store.dispatch("".concat(this.storeNamespace||this.storyStoreNamespace,"setHighlightedChartLabels"),e)}}},methods:{onClickOnLeftArrow:function(){this.commentaryIndex=this.modulo(this.commentaryIndex-1,this.availableCommentaries.length)},onClickOnRightArrow:function(){this.commentaryIndex=this.modulo(this.commentaryIndex+1,this.availableCommentaries.length)},modulo:function(e,s){return(e%s+s)%s},isCommentaryKeyAllowed:function(e){return!r.a.isArray(this.config)||this.config.includes(e)}}},_=(t("/app/node_modules/vue-loader/lib/loaders/pitcher.js??ref--4!/app/node_modules/mini-css-extract-plugin/dist/loader.js!/app/node_modules/css-loader/dist/cjs.js??ref--5-1!/app/node_modules/resolve-url-loader/index.js??ref--5-2!/app/node_modules/postcss-loader/src/index.js??ref--5-3!/app/node_modules/sass-loader/dist/cjs.js??ref--5-4!/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/slide/smart-commentary/index.vue?vue&type=style&index=0&id=17e15611&scoped=true&lang=scss&"),t("/app/node_modules/vue-loader/lib/loaders/pitcher.js??ref--4!/app/node_modules/mini-css-extract-plugin/dist/loader.js!/app/node_modules/css-loader/dist/cjs.js??ref--5-1!/app/node_modules/resolve-url-loader/index.js??ref--5-2!/app/node_modules/postcss-loader/src/index.js??ref--5-3!/app/node_modules/sass-loader/dist/cjs.js??ref--5-4!/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/slide/smart-commentary/index.vue?vue&type=style&index=1&lang=scss&"),t("/app/node_modules/vue-loader/lib/runtime/componentNormalizer.js")),b=Object(_.a)(y,function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"tc-story__smart-commentary"},[this._m(0),s("div",{staticClass:"tc-story__smart-commentary-left-arrow",on:{click:this.onClickOnLeftArrow}},[s("i",{staticClass:"fal fa-angle-left fa-3x"})]),s("div",{staticClass:"tc-story__smart-commentary-content",domProps:{innerHTML:this._s(this.commentaryContent)}}),s("div",{staticClass:"tc-story__smart-commentary-right-arrow",on:{click:this.onClickOnRightArrow}},[s("i",{staticClass:"fal fa-angle-right fa-3x"})])])},a,!1,null,"17e15611",null);s.default=b.exports},"/app/node_modules/vue-loader/lib/loaders/pitcher.js??ref--4!/app/node_modules/mini-css-extract-plugin/dist/loader.js!/app/node_modules/css-loader/dist/cjs.js??ref--5-1!/app/node_modules/resolve-url-loader/index.js??ref--5-2!/app/node_modules/postcss-loader/src/index.js??ref--5-3!/app/node_modules/sass-loader/dist/cjs.js??ref--5-4!/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/slide/smart-commentary/index.vue?vue&type=style&index=0&id=17e15611&scoped=true&lang=scss&":function(e,s,t){"use strict";var a=t("/app/node_modules/mini-css-extract-plugin/dist/loader.js!/app/node_modules/css-loader/dist/cjs.js??ref--5-1!/app/node_modules/vue-loader/lib/loaders/stylePostLoader.js!/app/node_modules/resolve-url-loader/index.js??ref--5-2!/app/node_modules/postcss-loader/src/index.js??ref--5-3!/app/node_modules/sass-loader/dist/cjs.js??ref--5-4!/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/slide/smart-commentary/index.vue?vue&type=style&index=0&id=17e15611&scoped=true&lang=scss&");t.n(a).a},"/app/node_modules/vue-loader/lib/loaders/pitcher.js??ref--4!/app/node_modules/mini-css-extract-plugin/dist/loader.js!/app/node_modules/css-loader/dist/cjs.js??ref--5-1!/app/node_modules/resolve-url-loader/index.js??ref--5-2!/app/node_modules/postcss-loader/src/index.js??ref--5-3!/app/node_modules/sass-loader/dist/cjs.js??ref--5-4!/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/slide/smart-commentary/index.vue?vue&type=style&index=1&lang=scss&":function(e,s,t){"use strict";var a=t("/app/node_modules/mini-css-extract-plugin/dist/loader.js!/app/node_modules/css-loader/dist/cjs.js??ref--5-1!/app/node_modules/vue-loader/lib/loaders/stylePostLoader.js!/app/node_modules/resolve-url-loader/index.js??ref--5-2!/app/node_modules/postcss-loader/src/index.js??ref--5-3!/app/node_modules/sass-loader/dist/cjs.js??ref--5-4!/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/slide/smart-commentary/index.vue?vue&type=style&index=1&lang=scss&");t.n(a).a}}]);