(this.webpackJsonp=this.webpackJsonp||[]).push([["tc-story-smart-commentary"],{"/app/node_modules/file-loader/dist/cjs.js??ref--10-0!/app/app/assets/images/icons/smart-toucan.svg":function(e,s,a){e.exports=a.p+"images/smart-toucan.9373aa66.svg"},"/app/node_modules/mini-css-extract-plugin/dist/loader.js!/app/node_modules/css-loader/dist/cjs.js!/app/node_modules/vue-loader/lib/loaders/stylePostLoader.js!/app/node_modules/resolve-url-loader/index.js!/app/node_modules/postcss-loader/src/index.js??ref--8-3!/app/node_modules/sass-loader/dist/cjs.js??ref--8-4!/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/slide/smart-commentary/index.vue?vue&type=style&index=0&id=17e15611&scoped=true&lang=scss&":function(e,s,a){},"/app/node_modules/mini-css-extract-plugin/dist/loader.js!/app/node_modules/css-loader/dist/cjs.js!/app/node_modules/vue-loader/lib/loaders/stylePostLoader.js!/app/node_modules/resolve-url-loader/index.js!/app/node_modules/postcss-loader/src/index.js??ref--8-3!/app/node_modules/sass-loader/dist/cjs.js??ref--8-4!/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/slide/smart-commentary/index.vue?vue&type=style&index=1&lang=scss&":function(e,s,a){},"/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/slide/smart-commentary/index.vue b2374b937f061665a2dba8a7746861da":function(e,s,a){"use strict";a.r(s);var t=[function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"tc-story__smart-commentary-logo"},[s("img",{attrs:{src:a("/app/node_modules/file-loader/dist/cjs.js??ref--10-0!/app/app/assets/images/icons/smart-toucan.svg")}})])}],o=a("/app/node_modules/lodash/lodash.js"),r=a.n(o),n=a("/app/node_modules/babel-loader/lib/index.js??ref--7-0!/app/node_modules/coffee-loader/index.js!/app/app/scripts/charts/utils/tc-chart-utils.coffee"),i=a.n(n),d=a("/app/node_modules/babel-loader/lib/index.js??ref--7-0!/app/node_modules/coffee-loader/index.js!/app/app/scripts/services/specifiers/precision-manager.coffee"),l=a.n(d),c=a("/app/node_modules/babel-loader/lib/index.js??ref--7-0!/app/node_modules/coffee-loader/index.js!/app/app/scripts/services/specifiers/unit-manager.coffee"),p=a.n(c),u=function(e,s,a){var t=r.a.sum(r.a.map(s,a));return Math.round(100*e/t)},m=function(e,s,a){if(!(e.length<3)){var t=e.slice(0,3),o=r.a.sum(r.a.map(t,a)),n=u(o,e,a);return{content:"The sum of the top 3 represents ".concat(n,"% of the total ").concat(a),relatedLabels:t.map(function(e){return e[s]})}}},f=function(e,s,a){if(!r.a.isEmpty(e)){var t=r.a.head(e),o=t[s],n=t[a],i=u(n,e,a);return{content:'<div class="tc-story__smart-commentary-label">'.concat(o,"</div> is first with ").concat(i,"% of the total ").concat(a),relatedLabels:[o]}}},v=function(e,s,a){if(!r.a.isEmpty(e)){var t=r.a.last(e),o=t[s],n=t[a],i=u(n,e,a);return{content:'<div class="tc-story__smart-commentary-label">'.concat(o,"</div> is last with ").concat(i,"% of the total ").concat(a),relatedLabels:[o]}}};var h=function(e,s,a,t){if(!r.a.isEmpty(e)&&null!=t){var o=function(e,s){return r.a.chain(e).filter(function(e){return r.a.isNumber(e[s])}).sort(function(e,a){return Math.abs(a[s])-Math.abs(e[s])}).first().value()}(e,t);if(o){var n=o[s],i=o[t],d=i>=0?"increased":"decreased",c="".concat(l.a.format(o,t,!0)).concat(p.a.get(o,t));return{content:0===i?"".concat(a," didn't change"):'<div class="tc-story__smart-commentary-label">'.concat(n,"</div> ").concat(a," has ").concat(d," of ").concat(c),relatedLabels:[n]}}}};function j(e,s){return function(e){if(Array.isArray(e))return e}(e)||function(e,s){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var a=[],t=!0,o=!1,r=void 0;try{for(var n,i=e[Symbol.iterator]();!(t=(n=i.next()).done)&&(a.push(n.value),!s||a.length!==s);t=!0);}catch(e){o=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(o)throw r}}return a}(e,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var y={name:"SmartCommentary",inject:{storeNamespace:{default:function(){return""}}},props:{config:{type:[Boolean,Array],default:!0},datasets:{type:Object,default:function(){return{}}},chartConfigs:{type:Array,default:function(){return[]}},storyStoreNamespace:{type:String,default:""}},data:function(){return{commentaryIndex:0}},computed:{commentary:function(){return this.availableCommentaries[this.commentaryIndex]},commentaryContent:function(){return this.commentary?this.commentary.content:"Sorry, no smart commentaries are available"},firstData:function(){var e=r.a.head(Object.values(this.datasets));return r.a.get(e,"filteredData")},firstChartConfig:function(){return r.a.head(this.chartConfigs)||{}},availableCommentaries:function(){var e=this;return r.a.isEmpty(this.firstData)||r.a.isEmpty(this.firstChartConfig)?[]:Object.entries(this.generatedCommentariesObject).filter(function(s){var a=j(s,1)[0];return e.isCommentaryKeyAllowed(a)}).map(function(e){return j(e,2)[1]}).filter(r.a.isObject)},generatedCommentariesObject:function(){return"horizontal-barchart"===this.firstChartConfig.chartType?(e={data:this.firstData,labelSelector:this.firstChartConfig.label,valueSelector:this.firstChartConfig.value,variationSelector:this.firstChartConfig.variation},s=e.data,a=e.labelSelector,t=e.valueSelector,o=e.variationSelector,r=i.a.orderingFunction({by:t,reverse:!0})(s),{sumOfTopThree:m(r,a,t),first:f(r,a,t),last:v(r,a,t),biggestVariation:h(s,a,t,o)}):{};var e,s,a,t,o,r}},watch:{commentary:{immediate:!0,handler:function(){var e=r.a.get(this.commentary,"relatedLabels",[]);this.$store.dispatch("".concat(this.storeNamespace||this.storyStoreNamespace,"setHighlightedChartLabels"),e)}}},methods:{onClickOnLeftArrow:function(){this.commentaryIndex=this.modulo(this.commentaryIndex-1,this.availableCommentaries.length)},onClickOnRightArrow:function(){this.commentaryIndex=this.modulo(this.commentaryIndex+1,this.availableCommentaries.length)},modulo:function(e,s){return(e%s+s)%s},isCommentaryKeyAllowed:function(e){return!r.a.isArray(this.config)||this.config.includes(e)}}},_=(a("/app/node_modules/vue-loader/lib/loaders/pitcher.js??ref--4!/app/node_modules/mini-css-extract-plugin/dist/loader.js!/app/node_modules/css-loader/dist/cjs.js!/app/node_modules/resolve-url-loader/index.js!/app/node_modules/postcss-loader/src/index.js??ref--8-3!/app/node_modules/sass-loader/dist/cjs.js??ref--8-4!/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/slide/smart-commentary/index.vue?vue&type=style&index=0&id=17e15611&scoped=true&lang=scss&"),a("/app/node_modules/vue-loader/lib/loaders/pitcher.js??ref--4!/app/node_modules/mini-css-extract-plugin/dist/loader.js!/app/node_modules/css-loader/dist/cjs.js!/app/node_modules/resolve-url-loader/index.js!/app/node_modules/postcss-loader/src/index.js??ref--8-3!/app/node_modules/sass-loader/dist/cjs.js??ref--8-4!/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/slide/smart-commentary/index.vue?vue&type=style&index=1&lang=scss&"),a("/app/node_modules/vue-loader/lib/runtime/componentNormalizer.js")),b=Object(_.a)(y,function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"tc-story__smart-commentary"},[this._m(0),s("div",{staticClass:"tc-story__smart-commentary-left-arrow",on:{click:this.onClickOnLeftArrow}},[s("i",{staticClass:"fal fa-angle-left fa-3x"})]),s("div",{staticClass:"tc-story__smart-commentary-content",domProps:{innerHTML:this._s(this.commentaryContent)}}),s("div",{staticClass:"tc-story__smart-commentary-right-arrow",on:{click:this.onClickOnRightArrow}},[s("i",{staticClass:"fal fa-angle-right fa-3x"})])])},t,!1,null,"17e15611",null);s.default=b.exports},"/app/node_modules/vue-loader/lib/loaders/pitcher.js??ref--4!/app/node_modules/mini-css-extract-plugin/dist/loader.js!/app/node_modules/css-loader/dist/cjs.js!/app/node_modules/resolve-url-loader/index.js!/app/node_modules/postcss-loader/src/index.js??ref--8-3!/app/node_modules/sass-loader/dist/cjs.js??ref--8-4!/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/slide/smart-commentary/index.vue?vue&type=style&index=0&id=17e15611&scoped=true&lang=scss&":function(e,s,a){"use strict";var t=a("/app/node_modules/mini-css-extract-plugin/dist/loader.js!/app/node_modules/css-loader/dist/cjs.js!/app/node_modules/vue-loader/lib/loaders/stylePostLoader.js!/app/node_modules/resolve-url-loader/index.js!/app/node_modules/postcss-loader/src/index.js??ref--8-3!/app/node_modules/sass-loader/dist/cjs.js??ref--8-4!/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/slide/smart-commentary/index.vue?vue&type=style&index=0&id=17e15611&scoped=true&lang=scss&");a.n(t).a},"/app/node_modules/vue-loader/lib/loaders/pitcher.js??ref--4!/app/node_modules/mini-css-extract-plugin/dist/loader.js!/app/node_modules/css-loader/dist/cjs.js!/app/node_modules/resolve-url-loader/index.js!/app/node_modules/postcss-loader/src/index.js??ref--8-3!/app/node_modules/sass-loader/dist/cjs.js??ref--8-4!/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/slide/smart-commentary/index.vue?vue&type=style&index=1&lang=scss&":function(e,s,a){"use strict";var t=a("/app/node_modules/mini-css-extract-plugin/dist/loader.js!/app/node_modules/css-loader/dist/cjs.js!/app/node_modules/vue-loader/lib/loaders/stylePostLoader.js!/app/node_modules/resolve-url-loader/index.js!/app/node_modules/postcss-loader/src/index.js??ref--8-3!/app/node_modules/sass-loader/dist/cjs.js??ref--8-4!/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/app/scripts/slide/smart-commentary/index.vue?vue&type=style&index=1&lang=scss&");a.n(t).a}}]);